<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HiGMal - High Gain Max Loss</title>
    <style>
        /* Basic Reset and British English Font */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 20px;
            padding: 0;
            background-color: #f4f7f9;
            color: #333;
        }

        /* Nav Styling */
        nav {
            margin-bottom: 20px;
        }
        nav a {
            text-decoration: none;
            color: #004d99;
            font-weight: bold;
            padding: 5px 10px;
            border: 1px solid #004d99;
            border-radius: 4px;
            transition: background-color 0.2s, color 0.2s;
        }
        nav a:hover {
            background-color: #004d99;
            color: white;
        }

        /* Container Styling */
        .container {
            max-width: 900px;
            margin: auto;
            background: #ffffff;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        h1 {
            color: #004d99; /* School Blue */
            border-bottom: 3px solid #f0ad4e;
            padding-bottom: 10px;
            margin-bottom: 25px;
        }

        h2 {
            color: #555;
            margin-top: 30px;
            border-left: 5px solid #004d99;
            padding-left: 10px;
        }

        /* Input and Button Styling */
        #item-input-group {
            display: flex;
            margin-bottom: 20px;
            gap: 10px;
        }

        #new-item-input {
            flex-grow: 1;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-size: 16px;
        }

        #add-item-btn, .action-btn {
            background-color: #5cb85c; /* Positive Green */
            color: white;
            padding: 10px 15px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.2s;
        }

        #add-item-btn:hover, .action-btn:hover {
            background-color: #4cae4c;
        }

        /* List Styling */
        .item-list-container {
            display: flex;
            gap: 20px;
            margin-bottom: 30px;
        }

        .item-list, #gain-order, #loss-order {
            list-style-type: none;
            padding: 10px;
            background-color: #e9ecef;
            border-radius: 4px;
            min-height: 150px;
            flex: 1;
            border: 1px solid #dee2e6;
        }

        .list-item {
            background-color: #ffffff;
            border: 1px solid #ddd;
            padding: 10px;
            margin-bottom: 5px;
            border-radius: 4px;
            cursor: grab;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .list-item:hover {
            box-shadow: 0 1px 4px rgba(0, 0, 0, 0.1);
        }

        /* Quadrant Styling */
        #quadrant-analysis {
            display: grid;
            grid-template-columns: 1fr 1fr;
            grid-template-rows: 1fr 1fr;
            height: 400px;
            border: 2px solid #333;
            margin-top: 30px;
            position: relative;
        }

        .quadrant {
            padding: 20px;
            border: 1px solid #ccc;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }

        /* Specific Quadrant Colours as requested */
        /* Top-Right: High Gain, Low Loss (Ideal) */
        #q1 { background-color: #ffd700; } /* Gold */
        /* Top-Left: High Gain, High Loss (High Risk/High Reward) */
        #q2 { background-color: #90ee90; } /* Light Green */
        /* Bottom-Left: Low Gain, High Loss (Avoid) */
        #q3 { background-color: #ff6347; } /* Light Red (Tomato for clear loss) */
        /* Bottom-Right: Low Gain, Min Loss (Safe/Maintenance) */
        #q4 { background-color: #ffa07a; } /* Light Orange (Light Salmon) */

        .quadrant h3 {
            margin-top: 0;
            color: #004d99;
        }

        /* Axis Labels */
        .axis-label {
            position: absolute;
            font-weight: bold;
            color: #333;
        }

        #gain-label { top: -25px; left: 50%; transform: translateX(-50%); }
        #loss-label { right: -50px; top: 50%; transform: translateY(-50%) rotate(90deg); }
    </style>
</head>
<body>
    <nav>
        <a href="index.html">&larr; Return to Dashboard</a>
    </nav>

    <div class="container">
        <h1>HiGMal: High Gain Max Loss Analysis Tool</h1>

        <p>
            This tool helps conceptualise the strategic positioning of ideas by assessing their potential maximum relative **Gain** versus their potential maximum relative **Loss**.
        </p>

        <h2>1. List Ideas/Items (Default Focus: 10)</h2>
        <div id="item-input-group">
            <input type="text" id="new-item-input" placeholder="Enter ideas (e.g., 'Idea A, Idea B, Idea C' or paste a list)...">
            <button id="add-item-btn">Add Item(s)</button>
        </div>

        <ul id="initial-list" class="item-list">
            </ul>
        <button id="clear-list-btn" class="action-btn" style="background-color: #dc3545;">Clear All</button>

        <h2>2. Strategic Arrangement (Simulated Drag-and-Drop)</h2>
        <p>
            *Please Note: The system will index the items based on the order you arrange them. **Max Gain** at the top, **Max Loss** at the top. Use the 'Lock In' button after arranging.*
        </p>

        <div class="item-list-container">
            <div>
                <h3>Max Gain Ordering (Highest Potential Gain at Top)</h3>
                <ul id="gain-order" class="item-list"></ul>
                <button onclick="lockInOrder('gain')" class="action-btn">Lock In Gain Order</button>
            </div>
            <div>
                <h3>Max Loss Ordering (Highest Potential Loss at Top)</h3>
                <ul id="loss-order" class="item-list"></ul>
                <button onclick="lockInOrder('loss')" class="action-btn">Lock In Loss Order</button>
            </div>
        </div>


        <h2>3. Quadrant Analysis</h2>
        

        <div id="quadrant-analysis">
            <span class="axis-label" id="gain-label">Relative Gain</span>
            <span class="axis-label" id="loss-label">Relative Loss</span>

            <div id="q2" class="quadrant">
                <h3>Max Gain, Max Loss</h3>
                <p>High Risk/High Reward, Requires Careful Management</p>
                <ul id="q2-items" style="list-style-type: disc;"></ul>
            </div>

            <div id="q1" class="quadrant">
                <h3>High Gain, Min Loss</h3>
                <p>**Golden Zone:** Prioritise Immediately</p>
                <ul id="q1-items" style="list-style-type: disc;"></ul>
            </div>

            <div id="q3" class="quadrant">
                <h3>Min Gain, Max Loss</h3>
                <p>High Risk/Low Reward: Avoid or Re-evaluate</p>
                <ul id="q3-items" style="list-style-type: disc;"></ul>
            </div>

            <div id="q4" class="quadrant">
                <h3>Min Gain, Min Loss</h3>
                <p>Maintenance/Safe Bets, Low Priority for Innovation</p>
                <ul id="q4-items" style="list-style-type: disc;"></ul>
            </div>
        </div>

        <p style="margin-top: 40px; font-style: italic;">
            *Analysis is based on a simple index mapping from your two manual orderings.*
        </p>
    </div>

    <script>
        // --- Core Application Logic (British English Naming) ---

        let ideas = [];
        // Removed maxItems constraint

        const initialListEl = document.getElementById('initial-list');
        const gainOrderEl = document.getElementById('gain-order');
        const lossOrderEl = document.getElementById('loss-order');
        const newItemInputEl = document.getElementById('new-item-input');

        // Function to render an item in a list (drag-and-drop simulated)
        function renderItem(itemText) {
            const li = document.createElement('li');
            li.className = 'list-item';
            li.textContent = itemText;
            li.draggable = true; // Enables drag functionality
            return li;
        }

        // Renders the current list of ideas to the initial list and both ordering lists
        function renderLists() {
            initialListEl.innerHTML = '';
            gainOrderEl.innerHTML = '';
            lossOrderEl.innerHTML = '';

            ideas.forEach(idea => {
                // Initial List (for reference)
                const refLi = document.createElement('li');
                refLi.className = 'list-item';
                refLi.textContent = idea;
                initialListEl.appendChild(refLi);

                // Populate Gain Order List (Draggable/Arrangement Area)
                const gainLi = renderItem(idea);
                gainOrderEl.appendChild(gainLi);

                // Populate Loss Order List (Draggable/Arrangement Area)
                const lossLi = renderItem(idea);
                lossOrderEl.appendChild(lossLi);
            });
            // Re-apply drag-and-drop handlers after list refresh
            addDragDropHandlers(gainOrderEl);
            addDragDropHandlers(lossOrderEl);
        }

        // Functionality to add new idea(s) (supports comma or newline separation)
        document.getElementById('add-item-btn').addEventListener('click', () => {
            const input = newItemInputEl.value.trim();
            if (input) {
                // Split by comma or newline, then filter out empty strings
                const newItems = input.split(/,|\n/).map(item => item.trim()).filter(item => item.length > 0);

                if (newItems.length > 0) {
                    // Only add items that are not already in the list to prevent duplication
                    newItems.forEach(item => {
                        if (!ideas.includes(item)) {
                            ideas.push(item);
                        }
                    });

                    newItemInputEl.value = '';
                    renderLists();
                }
            }
        });

        // Functionality to clear all ideas
        document.getElementById('clear-list-btn').addEventListener('click', () => {
            if (confirm('Are you sure you want to clear all listed ideas?')) {
                ideas = [];
                // Clear all quadrant content as well
                document.getElementById('q1-items').innerHTML = '';
                document.getElementById('q2-items').innerHTML = '';
                document.getElementById('q3-items').innerHTML = '';
                document.getElementById('q4-items').innerHTML = '';
                renderLists();
            }
        });

        // --- Drag and Drop Logic (Simplified) ---

        let draggedItem = null;

        function addDragDropHandlers(listEl) {
            const listItems = listEl.querySelectorAll('.list-item');
            listItems.forEach(item => {
                item.addEventListener('dragstart', (e) => {
                    draggedItem = item;
                    setTimeout(() => item.style.opacity = '0.5', 0);
                });

                item.addEventListener('dragend', () => {
                    draggedItem.style.opacity = '1';
                    draggedItem = null;
                });

                item.addEventListener('dragover', (e) => {
                    e.preventDefault(); // Allows drop
                    const bounding = item.getBoundingClientRect();
                    const offset = bounding.y + (bounding.height / 2);
                    // Visual cue for drop location
                    if (e.clientY > offset) {
                        item.style.borderBottom = '2px solid #004d99';
                        item.style.borderTop = 'none';
                    } else {
                        item.style.borderTop = '2px solid #004d99';
                        item.style.borderBottom = 'none';
                    }
                });

                item.addEventListener('dragleave', () => {
                    item.style.borderTop = 'none';
                    item.style.borderBottom = 'none';
                });

                item.addEventListener('drop', (e) => {
                    e.preventDefault();
                    item.style.borderTop = 'none';
                    item.style.borderBottom = 'none';

                    if (draggedItem && draggedItem !== item) {
                        const bounding = item.getBoundingClientRect();
                        const offset = bounding.y + (bounding.height / 2);

                        // Determine if dropping before or after the target item
                        if (e.clientY > offset) {
                            // Drop after the target
                            listEl.insertBefore(draggedItem, item.nextSibling);
                        } else {
                            // Drop before the target
                            listEl.insertBefore(draggedItem, item);
                        }
                    }
                });
            });
        }

        // --- Core HiGMal Calculation Logic ---

        // Locks in the current order and performs the quadrant calculation
        function lockInOrder(type) {
            // Get the current order of items from the respective list
            const currentGainOrder = Array.from(gainOrderEl.children).map(li => li.textContent.trim());
            const currentLossOrder = Array.from(lossOrderEl.children).map(li => li.textContent.trim());

            if (currentGainOrder.length === 0) {
                 alert('Please add and arrange some items before locking in.');
                 return;
            }

            // Ensure both orders are the same length (all items have been considered)
            if (currentGainOrder.length !== currentLossOrder.length) {
                alert('Please ensure both the Max Gain Ordering and Max Loss Ordering lists contain the same items before running the analysis.');
                return;
            }

            // Create a map for the 'rank' (index + 1) for each idea in both dimensions
            // Rank 1 is Max Gain or Max Loss
            const gainRanks = {};
            currentGainOrder.forEach((idea, index) => {
                // Rank is based on position: 1 (highest gain) to N (lowest gain)
                gainRanks[idea] = index + 1;
            });

            const lossRanks = {};
            currentLossOrder.forEach((idea, index) => {
                // Rank is based on position: 1 (highest loss) to N (lowest loss)
                lossRanks[idea] = index + 1;
            });

            // Clear previous results
            document.getElementById('q1-items').innerHTML = '';
            document.getElementById('q2-items').innerHTML = '';
            document.getElementById('q3-items').innerHTML = '';
            document.getElementById('q4-items').innerHTML = '';

            const N = currentGainOrder.length;
            // The split point for High/Low is simply the middle of the list
            const midPoint = Math.ceil(N / 2); // e.g., 5.5 for 10 items, 5 for 9 items

            // Iterate through all ideas and assign to a quadrant
            currentGainOrder.forEach(idea => {
                const gainRank = gainRanks[idea];
                const lossRank = lossRanks[idea];

                // Check for High Gain (Rank <= midPoint) and Low Gain (Rank > midPoint)
                const isHighGain = gainRank <= midPoint;
                // Check for High Loss (Rank <= midPoint) and Low Loss (Rank > midPoint)
                const isHighLoss = lossRank <= midPoint;

                const listItem = document.createElement('li');
                listItem.textContent = idea;

                let targetQuadrantId;

                if (isHighGain && !isHighLoss) {
                    // Q1: High Gain, Min Loss (Low Loss Rank) - Gold
                    targetQuadrantId = 'q1-items';
                } else if (isHighGain && isHighLoss) {
                    // Q2: Max Gain, Max Loss (High Loss Rank) - Light Green
                    targetQuadrantId = 'q2-items';
                } else if (!isHighGain && isHighLoss) {
                    // Q3: Min Gain, Max Loss (High Loss Rank) - Light Red
                    targetQuadrantId = 'q3-items';
                } else { // !isHighGain && !isHighLoss
                    // Q4: Min Gain, Min Loss (Low Loss Rank) - Light Orange
                    targetQuadrantId = 'q4-items';
                }

                document.getElementById(targetQuadrantId).appendChild(listItem);
            });

            alert(`Analysis complete! Ideas have been mapped to the quadrants based on your manual orderings. Ensure you press 'Lock In' for both gain and loss to see the full result.`);
        }

        // Initial setup
        document.addEventListener('DOMContentLoaded', () => {
            // Add a couple of initial example items
            ideas = [
                'New Co-curricular STEM Club',
                'Update VLE/LMS System',
                'Review Pastoral Care Handbook',
                'Replace Hall Projector'
            ];
            renderLists();
        });

    </script>
</body>
</html>
